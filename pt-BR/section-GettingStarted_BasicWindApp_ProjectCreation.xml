<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" []>

<section version="4.5" xmlns="http://docbook.org/ns/docbook" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:xi="http://www.w3.org/2001/XInclude" xsi:schemaLocation="http://docbook.org/ns/docbook http://www.docbook.org/xml/4.5/docbookx.dtd">
	<title>Criando o projeto</title>


	<para>
		<application>Wind Tooling</application>
		provê um template de projeto para aplicativos Wind pronto para usar.
	</para>


	<procedure>
		<title>Criando um projeto de aplicativo Wind</title>

		<step>
			No Eclipse, acesse o menu
			<menuchoice>
				<guimenu>File</guimenu>
				<guisubmenu>New</guisubmenu>
				<guisubmenu>Other...</guisubmenu>
			</menuchoice>
		</step>
		<step>
			Escolha o item
			<guilabel>Plug-in Project</guilabel>
			sob a categoria
			<guilabel>Plug-in Development</guilabel>
		</step>
		<step>
			Preencha o campo
			<guilabel>Project name</guilabel>
			com o nome que achar conveniente
		</step>

		<step>
			No grupo
			<guilabel>Target Platform</guilabel>
			escolha a opção
			<guilabel>an OSGI Framework</guilabel>
			e mantenha
			<guilabel>Equinox</guilabel>
			selecionado
		</step>

		<step>
			Clique em
			<guilabel>Next</guilabel>
			e altere as configurações conforme desejar, no entanto para este exemplo, o padrão servirá.
		</step>

		<step>
			Na lista
			<guilabel>Available Templates</guilabel>
			selecione o item
			<guilabel>Basic Wind App</guilabel>
			e clique em
			<guilabel>Finish</guilabel>

			<figure id="figure-BasicWindApp_ProjectCreation">
				<title>
					Selecionando o template
					<guilabel>Basic Wind App</guilabel>
				</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/wind_tooling_basic_app.png" format="PNG" />
					</imageobject>
				</mediaobject>
			</figure>
		</step>


		<step>
			<para>O projeto criado possui a seguinte estrutura:</para>

			<figure id="figure-BasicWindApp_ProjectStructure">
				<title>
					Estrutura do projeto
					<application>Basic</application>
				</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/basic_project_structure.png" format="PNG" />
					</imageobject>
				</mediaobject>
			</figure>
		</step>
	</procedure>
	

	<para>
		Você deve atentar para três arquivos em particular:
		<itemizedlist>
			<listitem>
				<filename>Activator.java</filename>
			</listitem>
			<listitem>
				<filename>basic.dmo</filename>
			</listitem>
			<listitem>
				<filename>wind-app.cfg</filename>
			</listitem>
		</itemizedlist>
	</para>
	
	
	<bridgehead wordsize="2">Activator</bridgehead>
	<para>
		Se você já possui experiência com desenvolvimento de OSGi Bundles ou plugins Eclipse, deve estar familiarizado
		com o Activator. Ele é responsável pelo start e stop do bundle, neste caso um Wind App. No momento de inicialização
		da plataforma, ou quando o seu aplicativo é inicializado individualmente, o activator é chamado com a finalidade de
		registrar o seu Wind App. A plataforma então irá fazer o reconhecimento do aplicativo e passar a
		gerenciá-lo. 

	</para>
	<para>
		De forma similar, acontece o stop do Wind App. Seja uma parada individual ou de toda a plataforma, o Activator
		será acionado caso queira reagir de alguma forma a este evento.
	</para>

	<example id="example-BasicWindApp_Activator">
		<title>Activator</title>
		<programlisting language="Java"><xi:include parse="text"
			href="extras/example-BasicWindApp_Activator.java_sample" xmlns:xi="http://www.w3.org/2001/XInclude" /></programlisting>
	</example>

	<para>
		Note que a superclasse é
		<classname>br.com.maisha.wind.lifecycle.WindActivator</classname>. Isso é necessário pois no método <methodname>start(BundleContext)</methodname> 
		há uma chamada para <methodname>super.start(BundleContext, ClassLoader)</methodname> passando o contexto (OSGi Context) e o classloader usado pelo seu Wind App. 
		O classloader será usado pela plataforma para compilar seus Objetos de Domínio e executar suas Regras de Negócio. 
		O objetivo dessa chamada é registrar o seu Wind App, permitindo que a plataforma o conheça e seja capaz de gerenciá-lo.
	</para>

	
	<bridgehead wordsize="2">basico.dmo</bridgehead>
	<para>
		Arquivos com a extensão *.dmo contém a definição de um Objeto de Domínio.
	</para>

	<example id="example-BasicWindApp_DMO">
		<title>Objeto de Domínio</title>
		<programlisting language="XML"><xi:include parse="text"
			href="extras/example-BasicWindApp_DMO.dmo_sample" xmlns:xi="http://www.w3.org/2001/XInclude" /></programlisting>
	</example>

</section>